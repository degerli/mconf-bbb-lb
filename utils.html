<!DOCTYPE html><html lang="en"><head><title>utils</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="utils"><meta name="groc-project-path" content="lib/utils.coffee"><meta name="groc-github-url" content="https://github.com/mconf/mconf-bbb-lb"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/mconf/mconf-bbb-lb/blob/master/lib/utils.coffee">lib/utils.coffee</a></div></div><div id="document"><div class="segment"><div class="comments"><div class="wrapper"><h1 id="utils-module">Utils module</h1>

<p>General utility methods.</p></div></div><div class="code"><div class="wrapper"><span class="nv">BigBlueButton = </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../lib/bigbluebutton&quot;</span><span class="p">)</span>
<span class="nv">Logger = </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;./logger&quot;</span><span class="p">)</span>
<span class="nv">Meeting = </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../models/meeting&quot;</span><span class="p">)</span>
<span class="nv">config = </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;../config&quot;</span><span class="p">)</span>
<span class="nv">request = </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;request&quot;</span><span class="p">)</span>
<span class="nv">url = </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">)</span>

<span class="nv">Utils = </span><span class="nx">exports</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Ruby-like gsub function. Source:
<a href="http://flochip.com/2011/09/06/rubys-string-gsub-in-javascript/">http://flochip.com/2011/09/06/rubys-string-gsub-in-javascript/</a></p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.gsub = </span><span class="nf">(source, pattern, replacement) -&gt;</span>
  <span class="nv">match = </span><span class="kc">undefined</span>
  <span class="nv">result = </span><span class="kc">undefined</span>
  <span class="k">return</span> <span class="nx">source</span> <span class="nx">unless</span> <span class="p">(</span><span class="nx">pattern</span><span class="o">?</span><span class="p">)</span> <span class="o">and</span> <span class="p">(</span><span class="nx">replacement</span><span class="o">?</span><span class="p">)</span>
  <span class="nv">result = </span><span class="s2">&quot;&quot;</span>
  <span class="k">while</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nv">match = </span><span class="nx">source</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)</span>
      <span class="nx">result</span> <span class="o">+=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">match</span><span class="p">.</span><span class="nx">index</span><span class="p">)</span>
      <span class="nx">result</span> <span class="o">+=</span> <span class="nx">replacement</span>
      <span class="nv">source = </span><span class="nx">source</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">match</span><span class="p">.</span><span class="nx">index</span> <span class="o">+</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nx">result</span> <span class="o">+=</span> <span class="nx">source</span>
      <span class="nv">source = </span><span class="s2">&quot;&quot;</span>
  <span class="nx">result</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Real <code>typeOf</code> a variable.
<a href="http://stackoverflow.com/questions/1303646/check-variable-whether-is-number-or-string-in-javascript">http://stackoverflow.com/questions/1303646/check-variable-whether-is-number-or-string-in-javascript</a>
Example: <code>if (realTypeOf([1,2]) == 'Array') ...</code>
TODO: there isn't a method in coffeescript for this?</p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.realTypeOf = </span><span class="nf">(obj) -&gt;</span>
  <span class="nb">Object</span><span class="o">::</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">slice</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Unescaping HTML entities. Source:
<a href="http://code.google.com/p/jslibs/wiki/JavascriptTips#Escape_and_unescape_HTML_entities">http://code.google.com/p/jslibs/wiki/JavascriptTips#Escape_and_unescape_HTML_entities</a></p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.unescapeEntities = </span><span class="nf">(str) -&gt;</span>
  <span class="nv">entityToCode =</span>
    <span class="nv">__proto__: </span><span class="kc">null</span><span class="p">,</span>
    <span class="nx">apos</span><span class="o">:</span><span class="mh">0x0027</span><span class="p">,</span><span class="nx">quot</span><span class="o">:</span><span class="mh">0x0022</span><span class="p">,</span><span class="nx">amp</span><span class="o">:</span><span class="mh">0x0026</span><span class="p">,</span><span class="nx">lt</span><span class="o">:</span><span class="mh">0x003C</span><span class="p">,</span><span class="nx">gt</span><span class="o">:</span><span class="mh">0x003E</span><span class="p">,</span><span class="nx">nbsp</span><span class="o">:</span><span class="mh">0x00A0</span><span class="p">,</span><span class="nx">iexcl</span><span class="o">:</span><span class="mh">0x00A1</span><span class="p">,</span><span class="nx">cent</span><span class="o">:</span><span class="mh">0x00A2</span><span class="p">,</span><span class="nx">pound</span><span class="o">:</span><span class="mh">0x00A3</span><span class="p">,</span>
    <span class="nx">curren</span><span class="o">:</span><span class="mh">0x00A4</span><span class="p">,</span><span class="nx">yen</span><span class="o">:</span><span class="mh">0x00A5</span><span class="p">,</span><span class="nx">brvbar</span><span class="o">:</span><span class="mh">0x00A6</span><span class="p">,</span><span class="nx">sect</span><span class="o">:</span><span class="mh">0x00A7</span><span class="p">,</span><span class="nx">uml</span><span class="o">:</span><span class="mh">0x00A8</span><span class="p">,</span><span class="nx">copy</span><span class="o">:</span><span class="mh">0x00A9</span><span class="p">,</span><span class="nx">ordf</span><span class="o">:</span><span class="mh">0x00AA</span><span class="p">,</span><span class="nx">laquo</span><span class="o">:</span><span class="mh">0x00AB</span><span class="p">,</span>
    <span class="o">not:</span><span class="mh">0x00AC</span><span class="p">,</span><span class="nx">shy</span><span class="o">:</span><span class="mh">0x00AD</span><span class="p">,</span><span class="nx">reg</span><span class="o">:</span><span class="mh">0x00AE</span><span class="p">,</span><span class="nx">macr</span><span class="o">:</span><span class="mh">0x00AF</span><span class="p">,</span><span class="nx">deg</span><span class="o">:</span><span class="mh">0x00B0</span><span class="p">,</span><span class="nx">plusmn</span><span class="o">:</span><span class="mh">0x00B1</span><span class="p">,</span><span class="nx">sup2</span><span class="o">:</span><span class="mh">0x00B2</span><span class="p">,</span><span class="nx">sup3</span><span class="o">:</span><span class="mh">0x00B3</span><span class="p">,</span>
    <span class="nx">acute</span><span class="o">:</span><span class="mh">0x00B4</span><span class="p">,</span><span class="nx">micro</span><span class="o">:</span><span class="mh">0x00B5</span><span class="p">,</span><span class="nx">para</span><span class="o">:</span><span class="mh">0x00B6</span><span class="p">,</span><span class="nx">middot</span><span class="o">:</span><span class="mh">0x00B7</span><span class="p">,</span><span class="nx">cedil</span><span class="o">:</span><span class="mh">0x00B8</span><span class="p">,</span><span class="nx">sup1</span><span class="o">:</span><span class="mh">0x00B9</span><span class="p">,</span><span class="nx">ordm</span><span class="o">:</span><span class="mh">0x00BA</span><span class="p">,</span><span class="nx">raquo</span><span class="o">:</span><span class="mh">0x00BB</span><span class="p">,</span>
    <span class="nx">frac14</span><span class="o">:</span><span class="mh">0x00BC</span><span class="p">,</span><span class="nx">frac12</span><span class="o">:</span><span class="mh">0x00BD</span><span class="p">,</span><span class="nx">frac34</span><span class="o">:</span><span class="mh">0x00BE</span><span class="p">,</span><span class="nx">iquest</span><span class="o">:</span><span class="mh">0x00BF</span><span class="p">,</span><span class="nx">Agrave</span><span class="o">:</span><span class="mh">0x00C0</span><span class="p">,</span><span class="nx">Aacute</span><span class="o">:</span><span class="mh">0x00C1</span><span class="p">,</span><span class="nx">Acirc</span><span class="o">:</span><span class="mh">0x00C2</span><span class="p">,</span><span class="nx">Atilde</span><span class="o">:</span><span class="mh">0x00C3</span><span class="p">,</span>
    <span class="nx">Auml</span><span class="o">:</span><span class="mh">0x00C4</span><span class="p">,</span><span class="nx">Aring</span><span class="o">:</span><span class="mh">0x00C5</span><span class="p">,</span><span class="nx">AElig</span><span class="o">:</span><span class="mh">0x00C6</span><span class="p">,</span><span class="nx">Ccedil</span><span class="o">:</span><span class="mh">0x00C7</span><span class="p">,</span><span class="nx">Egrave</span><span class="o">:</span><span class="mh">0x00C8</span><span class="p">,</span><span class="nx">Eacute</span><span class="o">:</span><span class="mh">0x00C9</span><span class="p">,</span><span class="nx">Ecirc</span><span class="o">:</span><span class="mh">0x00CA</span><span class="p">,</span><span class="nx">Euml</span><span class="o">:</span><span class="mh">0x00CB</span><span class="p">,</span>
    <span class="nx">Igrave</span><span class="o">:</span><span class="mh">0x00CC</span><span class="p">,</span><span class="nx">Iacute</span><span class="o">:</span><span class="mh">0x00CD</span><span class="p">,</span><span class="nx">Icirc</span><span class="o">:</span><span class="mh">0x00CE</span><span class="p">,</span><span class="nx">Iuml</span><span class="o">:</span><span class="mh">0x00CF</span><span class="p">,</span><span class="nx">ETH</span><span class="o">:</span><span class="mh">0x00D0</span><span class="p">,</span><span class="nx">Ntilde</span><span class="o">:</span><span class="mh">0x00D1</span><span class="p">,</span><span class="nx">Ograve</span><span class="o">:</span><span class="mh">0x00D2</span><span class="p">,</span><span class="nx">Oacute</span><span class="o">:</span><span class="mh">0x00D3</span><span class="p">,</span>
    <span class="nx">Ocirc</span><span class="o">:</span><span class="mh">0x00D4</span><span class="p">,</span><span class="nx">Otilde</span><span class="o">:</span><span class="mh">0x00D5</span><span class="p">,</span><span class="nx">Ouml</span><span class="o">:</span><span class="mh">0x00D6</span><span class="p">,</span><span class="nx">times</span><span class="o">:</span><span class="mh">0x00D7</span><span class="p">,</span><span class="nx">Oslash</span><span class="o">:</span><span class="mh">0x00D8</span><span class="p">,</span><span class="nx">Ugrave</span><span class="o">:</span><span class="mh">0x00D9</span><span class="p">,</span><span class="nx">Uacute</span><span class="o">:</span><span class="mh">0x00DA</span><span class="p">,</span><span class="nx">Ucirc</span><span class="o">:</span><span class="mh">0x00DB</span><span class="p">,</span>
    <span class="nx">Uuml</span><span class="o">:</span><span class="mh">0x00DC</span><span class="p">,</span><span class="nx">Yacute</span><span class="o">:</span><span class="mh">0x00DD</span><span class="p">,</span><span class="nx">THORN</span><span class="o">:</span><span class="mh">0x00DE</span><span class="p">,</span><span class="nx">szlig</span><span class="o">:</span><span class="mh">0x00DF</span><span class="p">,</span><span class="nx">agrave</span><span class="o">:</span><span class="mh">0x00E0</span><span class="p">,</span><span class="nx">aacute</span><span class="o">:</span><span class="mh">0x00E1</span><span class="p">,</span><span class="nx">acirc</span><span class="o">:</span><span class="mh">0x00E2</span><span class="p">,</span><span class="nx">atilde</span><span class="o">:</span><span class="mh">0x00E3</span><span class="p">,</span>
    <span class="nx">auml</span><span class="o">:</span><span class="mh">0x00E4</span><span class="p">,</span><span class="nx">aring</span><span class="o">:</span><span class="mh">0x00E5</span><span class="p">,</span><span class="nx">aelig</span><span class="o">:</span><span class="mh">0x00E6</span><span class="p">,</span><span class="nx">ccedil</span><span class="o">:</span><span class="mh">0x00E7</span><span class="p">,</span><span class="nx">egrave</span><span class="o">:</span><span class="mh">0x00E8</span><span class="p">,</span><span class="nx">eacute</span><span class="o">:</span><span class="mh">0x00E9</span><span class="p">,</span><span class="nx">ecirc</span><span class="o">:</span><span class="mh">0x00EA</span><span class="p">,</span><span class="nx">euml</span><span class="o">:</span><span class="mh">0x00EB</span><span class="p">,</span>
    <span class="nx">igrave</span><span class="o">:</span><span class="mh">0x00EC</span><span class="p">,</span><span class="nx">iacute</span><span class="o">:</span><span class="mh">0x00ED</span><span class="p">,</span><span class="nx">icirc</span><span class="o">:</span><span class="mh">0x00EE</span><span class="p">,</span><span class="nx">iuml</span><span class="o">:</span><span class="mh">0x00EF</span><span class="p">,</span><span class="nx">eth</span><span class="o">:</span><span class="mh">0x00F0</span><span class="p">,</span><span class="nx">ntilde</span><span class="o">:</span><span class="mh">0x00F1</span><span class="p">,</span><span class="nx">ograve</span><span class="o">:</span><span class="mh">0x00F2</span><span class="p">,</span><span class="nx">oacute</span><span class="o">:</span><span class="mh">0x00F3</span><span class="p">,</span>
    <span class="nx">ocirc</span><span class="o">:</span><span class="mh">0x00F4</span><span class="p">,</span><span class="nx">otilde</span><span class="o">:</span><span class="mh">0x00F5</span><span class="p">,</span><span class="nx">ouml</span><span class="o">:</span><span class="mh">0x00F6</span><span class="p">,</span><span class="nx">divide</span><span class="o">:</span><span class="mh">0x00F7</span><span class="p">,</span><span class="nx">oslash</span><span class="o">:</span><span class="mh">0x00F8</span><span class="p">,</span><span class="nx">ugrave</span><span class="o">:</span><span class="mh">0x00F9</span><span class="p">,</span><span class="nx">uacute</span><span class="o">:</span><span class="mh">0x00FA</span><span class="p">,</span><span class="nx">ucirc</span><span class="o">:</span><span class="mh">0x00FB</span><span class="p">,</span>
    <span class="nx">uuml</span><span class="o">:</span><span class="mh">0x00FC</span><span class="p">,</span><span class="nx">yacute</span><span class="o">:</span><span class="mh">0x00FD</span><span class="p">,</span><span class="nx">thorn</span><span class="o">:</span><span class="mh">0x00FE</span><span class="p">,</span><span class="nx">yuml</span><span class="o">:</span><span class="mh">0x00FF</span><span class="p">,</span><span class="nx">OElig</span><span class="o">:</span><span class="mh">0x0152</span><span class="p">,</span><span class="nx">oelig</span><span class="o">:</span><span class="mh">0x0153</span><span class="p">,</span><span class="nx">Scaron</span><span class="o">:</span><span class="mh">0x0160</span><span class="p">,</span><span class="nx">scaron</span><span class="o">:</span><span class="mh">0x0161</span><span class="p">,</span>
    <span class="nx">Yuml</span><span class="o">:</span><span class="mh">0x0178</span><span class="p">,</span><span class="nx">fnof</span><span class="o">:</span><span class="mh">0x0192</span><span class="p">,</span><span class="nx">circ</span><span class="o">:</span><span class="mh">0x02C6</span><span class="p">,</span><span class="nx">tilde</span><span class="o">:</span><span class="mh">0x02DC</span><span class="p">,</span><span class="nx">Alpha</span><span class="o">:</span><span class="mh">0x0391</span><span class="p">,</span><span class="nx">Beta</span><span class="o">:</span><span class="mh">0x0392</span><span class="p">,</span><span class="nx">Gamma</span><span class="o">:</span><span class="mh">0x0393</span><span class="p">,</span><span class="nx">Delta</span><span class="o">:</span><span class="mh">0x0394</span><span class="p">,</span>
    <span class="nx">Epsilon</span><span class="o">:</span><span class="mh">0x0395</span><span class="p">,</span><span class="nx">Zeta</span><span class="o">:</span><span class="mh">0x0396</span><span class="p">,</span><span class="nx">Eta</span><span class="o">:</span><span class="mh">0x0397</span><span class="p">,</span><span class="nx">Theta</span><span class="o">:</span><span class="mh">0x0398</span><span class="p">,</span><span class="nx">Iota</span><span class="o">:</span><span class="mh">0x0399</span><span class="p">,</span><span class="nx">Kappa</span><span class="o">:</span><span class="mh">0x039A</span><span class="p">,</span><span class="nx">Lambda</span><span class="o">:</span><span class="mh">0x039B</span><span class="p">,</span><span class="nx">Mu</span><span class="o">:</span><span class="mh">0x039C</span><span class="p">,</span>
    <span class="nx">Nu</span><span class="o">:</span><span class="mh">0x039D</span><span class="p">,</span><span class="nx">Xi</span><span class="o">:</span><span class="mh">0x039E</span><span class="p">,</span><span class="nx">Omicron</span><span class="o">:</span><span class="mh">0x039F</span><span class="p">,</span><span class="nx">Pi</span><span class="o">:</span><span class="mh">0x03A0</span><span class="p">,</span><span class="nx">Rho</span><span class="o">:</span><span class="mh">0x03A1</span><span class="p">,</span><span class="nx">Sigma</span><span class="o">:</span><span class="mh">0x03A3</span><span class="p">,</span><span class="nx">Tau</span><span class="o">:</span><span class="mh">0x03A4</span><span class="p">,</span><span class="nx">Upsilon</span><span class="o">:</span><span class="mh">0x03A5</span><span class="p">,</span>
    <span class="nx">Phi</span><span class="o">:</span><span class="mh">0x03A6</span><span class="p">,</span><span class="nx">Chi</span><span class="o">:</span><span class="mh">0x03A7</span><span class="p">,</span><span class="nx">Psi</span><span class="o">:</span><span class="mh">0x03A8</span><span class="p">,</span><span class="nx">Omega</span><span class="o">:</span><span class="mh">0x03A9</span><span class="p">,</span><span class="nx">alpha</span><span class="o">:</span><span class="mh">0x03B1</span><span class="p">,</span><span class="nx">beta</span><span class="o">:</span><span class="mh">0x03B2</span><span class="p">,</span><span class="nx">gamma</span><span class="o">:</span><span class="mh">0x03B3</span><span class="p">,</span><span class="nx">delta</span><span class="o">:</span><span class="mh">0x03B4</span><span class="p">,</span>
    <span class="nx">epsilon</span><span class="o">:</span><span class="mh">0x03B5</span><span class="p">,</span><span class="nx">zeta</span><span class="o">:</span><span class="mh">0x03B6</span><span class="p">,</span><span class="nx">eta</span><span class="o">:</span><span class="mh">0x03B7</span><span class="p">,</span><span class="nx">theta</span><span class="o">:</span><span class="mh">0x03B8</span><span class="p">,</span><span class="nx">iota</span><span class="o">:</span><span class="mh">0x03B9</span><span class="p">,</span><span class="nx">kappa</span><span class="o">:</span><span class="mh">0x03BA</span><span class="p">,</span><span class="nx">lambda</span><span class="o">:</span><span class="mh">0x03BB</span><span class="p">,</span><span class="nx">mu</span><span class="o">:</span><span class="mh">0x03BC</span><span class="p">,</span>
    <span class="nx">nu</span><span class="o">:</span><span class="mh">0x03BD</span><span class="p">,</span><span class="nx">xi</span><span class="o">:</span><span class="mh">0x03BE</span><span class="p">,</span><span class="nx">omicron</span><span class="o">:</span><span class="mh">0x03BF</span><span class="p">,</span><span class="nx">pi</span><span class="o">:</span><span class="mh">0x03C0</span><span class="p">,</span><span class="nx">rho</span><span class="o">:</span><span class="mh">0x03C1</span><span class="p">,</span><span class="nx">sigmaf</span><span class="o">:</span><span class="mh">0x03C2</span><span class="p">,</span><span class="nx">sigma</span><span class="o">:</span><span class="mh">0x03C3</span><span class="p">,</span><span class="nx">tau</span><span class="o">:</span><span class="mh">0x03C4</span><span class="p">,</span>
    <span class="nx">upsilon</span><span class="o">:</span><span class="mh">0x03C5</span><span class="p">,</span><span class="nx">phi</span><span class="o">:</span><span class="mh">0x03C6</span><span class="p">,</span><span class="nx">chi</span><span class="o">:</span><span class="mh">0x03C7</span><span class="p">,</span><span class="nx">psi</span><span class="o">:</span><span class="mh">0x03C8</span><span class="p">,</span><span class="nx">omega</span><span class="o">:</span><span class="mh">0x03C9</span><span class="p">,</span><span class="nx">thetasym</span><span class="o">:</span><span class="mh">0x03D1</span><span class="p">,</span><span class="nx">upsih</span><span class="o">:</span><span class="mh">0x03D2</span><span class="p">,</span><span class="nx">piv</span><span class="o">:</span><span class="mh">0x03D6</span><span class="p">,</span>
    <span class="nx">ensp</span><span class="o">:</span><span class="mh">0x2002</span><span class="p">,</span><span class="nx">emsp</span><span class="o">:</span><span class="mh">0x2003</span><span class="p">,</span><span class="nx">thinsp</span><span class="o">:</span><span class="mh">0x2009</span><span class="p">,</span><span class="nx">zwnj</span><span class="o">:</span><span class="mh">0x200C</span><span class="p">,</span><span class="nx">zwj</span><span class="o">:</span><span class="mh">0x200D</span><span class="p">,</span><span class="nx">lrm</span><span class="o">:</span><span class="mh">0x200E</span><span class="p">,</span><span class="nx">rlm</span><span class="o">:</span><span class="mh">0x200F</span><span class="p">,</span><span class="nx">ndash</span><span class="o">:</span><span class="mh">0x2013</span><span class="p">,</span>
    <span class="nx">mdash</span><span class="o">:</span><span class="mh">0x2014</span><span class="p">,</span><span class="nx">lsquo</span><span class="o">:</span><span class="mh">0x2018</span><span class="p">,</span><span class="nx">rsquo</span><span class="o">:</span><span class="mh">0x2019</span><span class="p">,</span><span class="nx">sbquo</span><span class="o">:</span><span class="mh">0x201A</span><span class="p">,</span><span class="nx">ldquo</span><span class="o">:</span><span class="mh">0x201C</span><span class="p">,</span><span class="nx">rdquo</span><span class="o">:</span><span class="mh">0x201D</span><span class="p">,</span><span class="nx">bdquo</span><span class="o">:</span><span class="mh">0x201E</span><span class="p">,</span><span class="nx">dagger</span><span class="o">:</span><span class="mh">0x2020</span><span class="p">,</span>
    <span class="nx">Dagger</span><span class="o">:</span><span class="mh">0x2021</span><span class="p">,</span><span class="nx">bull</span><span class="o">:</span><span class="mh">0x2022</span><span class="p">,</span><span class="nx">hellip</span><span class="o">:</span><span class="mh">0x2026</span><span class="p">,</span><span class="nx">permil</span><span class="o">:</span><span class="mh">0x2030</span><span class="p">,</span><span class="nx">prime</span><span class="o">:</span><span class="mh">0x2032</span><span class="p">,</span><span class="nx">Prime</span><span class="o">:</span><span class="mh">0x2033</span><span class="p">,</span><span class="nx">lsaquo</span><span class="o">:</span><span class="mh">0x2039</span><span class="p">,</span><span class="nx">rsaquo</span><span class="o">:</span><span class="mh">0x203A</span><span class="p">,</span>
    <span class="nx">oline</span><span class="o">:</span><span class="mh">0x203E</span><span class="p">,</span><span class="nx">frasl</span><span class="o">:</span><span class="mh">0x2044</span><span class="p">,</span><span class="nx">euro</span><span class="o">:</span><span class="mh">0x20AC</span><span class="p">,</span><span class="nx">image</span><span class="o">:</span><span class="mh">0x2111</span><span class="p">,</span><span class="nx">weierp</span><span class="o">:</span><span class="mh">0x2118</span><span class="p">,</span><span class="nx">real</span><span class="o">:</span><span class="mh">0x211C</span><span class="p">,</span><span class="nx">trade</span><span class="o">:</span><span class="mh">0x2122</span><span class="p">,</span><span class="nx">alefsym</span><span class="o">:</span><span class="mh">0x2135</span><span class="p">,</span>
    <span class="nx">larr</span><span class="o">:</span><span class="mh">0x2190</span><span class="p">,</span><span class="nx">uarr</span><span class="o">:</span><span class="mh">0x2191</span><span class="p">,</span><span class="nx">rarr</span><span class="o">:</span><span class="mh">0x2192</span><span class="p">,</span><span class="nx">darr</span><span class="o">:</span><span class="mh">0x2193</span><span class="p">,</span><span class="nx">harr</span><span class="o">:</span><span class="mh">0x2194</span><span class="p">,</span><span class="nx">crarr</span><span class="o">:</span><span class="mh">0x21B5</span><span class="p">,</span><span class="nx">lArr</span><span class="o">:</span><span class="mh">0x21D0</span><span class="p">,</span><span class="nx">uArr</span><span class="o">:</span><span class="mh">0x21D1</span><span class="p">,</span>
    <span class="nx">rArr</span><span class="o">:</span><span class="mh">0x21D2</span><span class="p">,</span><span class="nx">dArr</span><span class="o">:</span><span class="mh">0x21D3</span><span class="p">,</span><span class="nx">hArr</span><span class="o">:</span><span class="mh">0x21D4</span><span class="p">,</span><span class="nx">forall</span><span class="o">:</span><span class="mh">0x2200</span><span class="p">,</span><span class="nx">part</span><span class="o">:</span><span class="mh">0x2202</span><span class="p">,</span><span class="nx">exist</span><span class="o">:</span><span class="mh">0x2203</span><span class="p">,</span><span class="nx">empty</span><span class="o">:</span><span class="mh">0x2205</span><span class="p">,</span><span class="nx">nabla</span><span class="o">:</span><span class="mh">0x2207</span><span class="p">,</span>
    <span class="nx">isin</span><span class="o">:</span><span class="mh">0x2208</span><span class="p">,</span><span class="nx">notin</span><span class="o">:</span><span class="mh">0x2209</span><span class="p">,</span><span class="nx">ni</span><span class="o">:</span><span class="mh">0x220B</span><span class="p">,</span><span class="nx">prod</span><span class="o">:</span><span class="mh">0x220F</span><span class="p">,</span><span class="nx">sum</span><span class="o">:</span><span class="mh">0x2211</span><span class="p">,</span><span class="nx">minus</span><span class="o">:</span><span class="mh">0x2212</span><span class="p">,</span><span class="nx">lowast</span><span class="o">:</span><span class="mh">0x2217</span><span class="p">,</span><span class="nx">radic</span><span class="o">:</span><span class="mh">0x221A</span><span class="p">,</span>
    <span class="nx">prop</span><span class="o">:</span><span class="mh">0x221D</span><span class="p">,</span><span class="nx">infin</span><span class="o">:</span><span class="mh">0x221E</span><span class="p">,</span><span class="nx">ang</span><span class="o">:</span><span class="mh">0x2220</span><span class="p">,</span><span class="o">and:</span><span class="mh">0x2227</span><span class="p">,</span><span class="o">or:</span><span class="mh">0x2228</span><span class="p">,</span><span class="nx">cap</span><span class="o">:</span><span class="mh">0x2229</span><span class="p">,</span><span class="nx">cup</span><span class="o">:</span><span class="mh">0x222A</span><span class="p">,</span><span class="nx">int</span><span class="o">:</span><span class="mh">0x222B</span><span class="p">,</span>
    <span class="nx">there4</span><span class="o">:</span><span class="mh">0x2234</span><span class="p">,</span><span class="nx">sim</span><span class="o">:</span><span class="mh">0x223C</span><span class="p">,</span><span class="nx">cong</span><span class="o">:</span><span class="mh">0x2245</span><span class="p">,</span><span class="nx">asymp</span><span class="o">:</span><span class="mh">0x2248</span><span class="p">,</span><span class="nx">ne</span><span class="o">:</span><span class="mh">0x2260</span><span class="p">,</span><span class="nx">equiv</span><span class="o">:</span><span class="mh">0x2261</span><span class="p">,</span><span class="nx">le</span><span class="o">:</span><span class="mh">0x2264</span><span class="p">,</span><span class="nx">ge</span><span class="o">:</span><span class="mh">0x2265</span><span class="p">,</span>
    <span class="nx">sub</span><span class="o">:</span><span class="mh">0x2282</span><span class="p">,</span><span class="nx">sup</span><span class="o">:</span><span class="mh">0x2283</span><span class="p">,</span><span class="nx">nsub</span><span class="o">:</span><span class="mh">0x2284</span><span class="p">,</span><span class="nx">sube</span><span class="o">:</span><span class="mh">0x2286</span><span class="p">,</span><span class="nx">supe</span><span class="o">:</span><span class="mh">0x2287</span><span class="p">,</span><span class="nx">oplus</span><span class="o">:</span><span class="mh">0x2295</span><span class="p">,</span><span class="nx">otimes</span><span class="o">:</span><span class="mh">0x2297</span><span class="p">,</span><span class="nx">perp</span><span class="o">:</span><span class="mh">0x22A5</span><span class="p">,</span>
    <span class="nx">sdot</span><span class="o">:</span><span class="mh">0x22C5</span><span class="p">,</span><span class="nx">lceil</span><span class="o">:</span><span class="mh">0x2308</span><span class="p">,</span><span class="nx">rceil</span><span class="o">:</span><span class="mh">0x2309</span><span class="p">,</span><span class="nx">lfloor</span><span class="o">:</span><span class="mh">0x230A</span><span class="p">,</span><span class="nx">rfloor</span><span class="o">:</span><span class="mh">0x230B</span><span class="p">,</span><span class="nx">lang</span><span class="o">:</span><span class="mh">0x2329</span><span class="p">,</span><span class="nx">rang</span><span class="o">:</span><span class="mh">0x232A</span><span class="p">,</span><span class="nx">loz</span><span class="o">:</span><span class="mh">0x25CA</span><span class="p">,</span>
    <span class="nx">spades</span><span class="o">:</span><span class="mh">0x2660</span><span class="p">,</span><span class="nx">clubs</span><span class="o">:</span><span class="mh">0x2663</span><span class="p">,</span><span class="nx">hearts</span><span class="o">:</span><span class="mh">0x2665</span><span class="p">,</span><span class="nx">diams</span><span class="o">:</span><span class="mh">0x2666</span>
  <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/&amp;(.+?);/g</span><span class="p">,</span> <span class="nf">(str, ent) -&gt;</span>
    <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span> <span class="p">(</span><span class="k">if</span> <span class="nx">ent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">isnt</span> <span class="s2">&quot;#&quot;</span> <span class="k">then</span> <span class="nx">entityToCode</span><span class="p">[</span><span class="nx">ent</span><span class="p">]</span> <span class="k">else</span> <span class="p">(</span><span class="k">if</span> <span class="nx">ent</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">is</span> <span class="s2">&quot;x&quot;</span> <span class="k">then</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">ent</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span> <span class="k">else</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">ent</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">))))</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get the method name of a BBB call from the url object (from url.parse())
Example:</p>

<ul>
<li><code>urlObj</code> = <code>http://mconf.org/bigbluebutton/api/create?name=Demo+Meeting&amp;meetingID=Demo</code></li>
<li>returns: <code>create</code></li>
</ul></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.bbbMethodFromUrl = </span><span class="nf">(urlObj) -&gt;</span>
  <span class="nx">urlObj</span><span class="p">.</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">substr</span> <span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">bbb</span><span class="p">.</span><span class="nx">apiPath</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">).</span><span class="nx">length</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get the query of a BBB call from the url object (from url.parse())
Example:</p>

<ul>
<li><code>urlObj</code> = <code>http://mconf.org/bigbluebutton/api/create?name=Demo+Meeting&amp;meetingID=Demo</code></li>
<li>returns: <code>name=Demo+Meeting&amp;meetingID=Demo</code></li>
</ul></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.bbbQueryFromUrl = </span><span class="nf">(urlObj) -&gt;</span>
  <span class="nx">url</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">urlObj</span><span class="p">).</span><span class="nx">substr</span> <span class="nx">urlObj</span><span class="p">.</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">1</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Sends a request with the url <code>originalUrl</code> to <code>server</code>.</p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.requestToServer = </span><span class="nf">(originalUrl, server, callback) -&gt;</span>
  <span class="nv">opt =</span>
    <span class="nv">url: </span><span class="nx">BigBlueButton</span><span class="p">.</span><span class="nx">formatBBBUrl</span><span class="p">(</span><span class="nx">originalUrl</span><span class="p">,</span> <span class="nx">server</span><span class="p">)</span>
    <span class="nv">timeout: </span><span class="nx">config</span><span class="p">.</span><span class="nx">lb</span><span class="p">.</span><span class="nx">requestTimeout</span>

  <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;sending &quot;</span> <span class="o">+</span> <span class="nx">opt</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
  <span class="nx">request</span> <span class="nx">opt</span><span class="p">,</span> <span class="nf">(error, res, body) -&gt;</span>
    <span class="nx">callback</span> <span class="nx">error</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">body</span><span class="p">,</span> <span class="nx">server</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Prints/Logs the meetings stored in the db.</p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.printMeetings = </span><span class="nf">(full) -&gt;</span>
  <span class="nv">meetings = </span><span class="nx">Meeting</span><span class="p">.</span><span class="nx">allSync</span><span class="p">()</span>
  <span class="k">if</span> <span class="nx">meetings</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">0</span>
    <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;there are no meetings registered&quot;</span>
  <span class="k">else</span>
    <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;list of meetings registered:&quot;</span>
    <span class="k">if</span> <span class="nx">full</span><span class="o">?</span> <span class="o">and</span> <span class="nx">full</span>
      <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">meetings</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="k">for</span> <span class="nx">id</span> <span class="k">of</span> <span class="nx">meetings</span>
        <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="nx">meetings</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">server</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;] &quot;</span> <span class="o">+</span> <span class="nx">meetings</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">id</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Removes <code>param</code> from the <code>urlObj</code> (parsed with <code>url.parse(..., true)</code>)
and returns the value of the param if found.</p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.removeParamFromUrl = </span><span class="nf">(urlObj, param) -&gt;</span>
  <span class="nv">ret = </span><span class="s2">&quot;&quot;</span>
  <span class="k">delete</span> <span class="nx">urlObj</span><span class="p">.</span><span class="nx">search</span> <span class="k">if</span> <span class="nx">urlObj</span><span class="p">.</span><span class="nx">search</span><span class="o">?</span>
  <span class="k">if</span> <span class="nx">urlObj</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span>
    <span class="nv">ret = </span><span class="nx">urlObj</span><span class="p">.</span><span class="nx">query</span><span class="p">[</span><span class="nx">param</span><span class="p">]</span>
    <span class="k">delete</span> <span class="nx">urlObj</span><span class="p">.</span><span class="nx">query</span><span class="p">[</span><span class="nx">param</span><span class="p">]</span>
  <span class="nx">ret</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Copy the headers from a response object to another.</p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.copyHeaders = </span><span class="nf">(from, to) -&gt;</span>
  <span class="nv">to.statusCode = </span><span class="nx">from</span><span class="p">.</span><span class="nx">statusCode</span>
  <span class="k">for</span> <span class="nx">name</span> <span class="k">of</span> <span class="nx">from</span><span class="p">.</span><span class="nx">headers</span>
    <span class="nx">to</span><span class="p">.</span><span class="nx">setHeader</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">from</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Receives an array of <code>Meeting</code>'s and replace the current meetings db with them.</p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.updateMeetings = </span><span class="nf">(meetings) -&gt;</span>
  <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;updating the meetings db&quot;</span>
  <span class="nx">Meeting</span><span class="p">.</span><span class="nx">clearSync</span><span class="p">()</span>
  <span class="k">for</span> <span class="nx">id</span> <span class="k">of</span> <span class="nx">meetings</span>
    <span class="nx">meetings</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">saveSync</span><span class="p">()</span>
  <span class="nx">Utils</span><span class="p">.</span><span class="nx">printMeetings</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Method to flatten arrays. Will only work for 1 level and if all elements are arrays.
Example: <code>[[1, 2], [3, 4]].flatten()</code></p></div></div><div class="code"><div class="wrapper"><span class="nv">Utils.flatten = flatten = </span><span class="nf">(array) -&gt;</span>
  <span class="nx">array</span><span class="p">.</span><span class="nx">reduce</span> <span class="nf">(a, b) -&gt;</span>
    <span class="nx">a</span><span class="p">.</span><span class="nx">concat</span> <span class="nx">b</span></div></div></div></div></body></html>